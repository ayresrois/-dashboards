<gadget>
  <prompt-parameters>
    <parameter id="P_PERIODO" description="Periodo" metadata="datePeriod" required="true" keep-last="true" keep-date="false" order="0"/>
    <parameter id="P_CODEMP" description="Empresa" metadata="multiList:Text" listType="sql" required="true" keep-last="true" keep-date="false" order="1">
      <expression type="SQL"><![CDATA[SELECT CODEMP AS VALUE,TO_CHAR(CODEMP) || ' - ' || RAZAOABREV AS LABELFROM TSIEMP ORDER BY 1]]></expression>
    </parameter>
    <parameter id="P_CODCENCUS" description="Cód. Centro de Resultado" metadata="multiList:Text" listType="sql" required="true" keep-last="true" keep-date="false" order="2">
      <expression type="SQL"><![CDATA[SELECT CODCENCUS AS VALUE, CODCENCUS ||'-'||DESCRCENCUS AS LABEL FROM TSICUS WHERE ANALITICO='S' AND ATIVO = 'S' ORDER BY 1 ]]></expression>
    </parameter>
    <parameter id="P_PROJETO" description="Cód. Projeto" metadata="multiList:Text" listType="sql" required="true" keep-last="true" keep-date="false" order="3">
      <expression type="SQL"><![CDATA[SELECT CODPROJ AS VALUE, CODPROJ ||'-'||IDENTIFICACAO AS LABEL FROM TCSPRJ WHERE ANALITICO='S' AND ATIVO = 'S' ORDER BY 1]]></expression>
    </parameter>
  </prompt-parameters>
  <level id="lvl_a6616yh" description="Principal">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="32100">
        <grid id="grd_d7g8pm" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[WITH COMPARATIVO AS (SELECT 	10000 CODNAT	, 'RECEITA BRUTA' DESCRNAT	, 0 AS ORDEM	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO	, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO	, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTALFROM TGFCAB CAB	INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER	INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA	INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 	INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT	LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAIWHERE 	CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND TPO.GOLSINAL = -1	AND CAB.STATUSNOTA = 'L'	AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))	AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')	AND ITE.SEQUENCIA > 0	AND CAB.CODEMP IN :P_CODEMP	AND CAB.CODCENCUS IN :P_CODCENCUS	AND CAB.CODPROJ IN :P_PROJETO	AND SUBSTR(CAB.CODNAT,1,3) = 101 /*RECEITA DE VENDAS BRUTA*/)SELECT Z.*	, CASE WHEN ORDEM IN (2,4,6,7,9,11,14,16) THEN '#2A7344' END AS BKCOLOR	, CASE WHEN ORDEM IN (2,4,6,7,9,11,14,16) THEN '#ffffff' END AS FGCOLOR	FROM(/*****************************************************************************************************************************/* RECEITA BRUTA */	SELECT 		CAB.CODNAT		,  NAT.DESCRNAT		, 1 AS ORDEM		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO					, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12		, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTAL			, ROUND(SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFCAB CAB 		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	 	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 	 	GROUP BY 		CAB.CODNAT		, NAT.DESCRNAT				UNION ALL 	/*****************************************************************************************************************************/* TOTALIZADOR  DEDUÇÕES DE IMPOSTOS E OUTRAS DEDUÇÕES */	SELECT		0 AS CODNAT		, 'DEDUÇÕES TOTAIS' AS DESCRNAT		, 2 AS ORDEM		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO					, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12		, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL			, ROUND(SUM( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13						FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290		INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA		INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 	GROUP BY		1,2			UNION ALL/*****************************************************************************************************************************/* DEDUÇÕES DE IMPOSTOS E OUTRAS DEDUÇÕES */	SELECT		DIN.CODIMP		,  CASE WHEN DIN.CODIMP = 1 THEN 'ICMS' WHEN DIN.CODIMP = 2 THEN 'ICMS ST' WHEN DIN.CODIMP = 3 THEN 'IPI' WHEN DIN.CODIMP = 6 THEN 'PIS' WHEN DIN.CODIMP = 7 THEN 'COFINS' ELSE 'OUTROS' END AS DESCRNAT		, 3 AS ORDEM		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO					, ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12		, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL			, ROUND(SUM( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13						FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290		INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA		INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 	GROUP BY		DIN.CODIMP		, CASE WHEN DIN.CODIMP = 1 THEN 'ICMS' WHEN DIN.CODIMP = 2 THEN 'ICMS ST' WHEN DIN.CODIMP = 3 THEN 'IPI' WHEN DIN.CODIMP = 6 THEN 'PIS' WHEN DIN.CODIMP = 7 THEN 'COFINS' ELSE 'OUTROS' END	UNION ALL/*****************************************************************************************************************************/* RECEITA LIQUIDA - PORTAL/FINANCEIRO */ 	SELECT 		10000		, '( = ) RECEITA LÍQUIDA' 		, 4 AS ORDEM		,SUM(JANEIRO) AS JANEIRO 			,ROUND(SUM(JANEIRO) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		,SUM(FEVEREIRO) AS FEVEREIRO			,ROUND(SUM(FEVEREIRO) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		,SUM(MARCO) AS MARCO 			,ROUND(SUM(MARCO) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		,SUM(ABRIL) AS ABRIL 			,ROUND(SUM(ABRIL) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4		,SUM(MAIO) AS MAIO			,ROUND(SUM(MAIO) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5		,SUM(JUNHO) AS JUNHO 			,ROUND(SUM(JUNHO) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		,SUM(JULHO) AS JULHO 			,ROUND(SUM(JULHO) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		,SUM(AGOSTO) AS AGOSTO 			,ROUND(SUM(AGOSTO) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		,SUM(SETEMBRO) AS SETEMBRO 			,ROUND(SUM(SETEMBRO) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		,SUM(OUTUBRO) AS OUTUBRO 			,ROUND(SUM(OUTUBRO) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		,SUM(NOVEMBRO) AS NOVEMBRO 			,ROUND(SUM(NOVEMBRO) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		,SUM(DEZEMBRO) AS DEZEMBRO 			,ROUND(SUM(DEZEMBRO) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12		,SUM(TOTAL) AS TOTAL  			,ROUND(SUM(TOTAL) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM (		SELECT 			SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO					, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTAL		FROM TGFCAB CAB 			INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER			INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA			INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 			INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT			LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI		 		WHERE 			CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN			AND TPO.GOLSINAL = -1			AND CAB.STATUSNOTA = 'L'			AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))			AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')			AND ITE.SEQUENCIA > 0			AND CAB.CODEMP IN :P_CODEMP			AND CAB.CODCENCUS IN :P_CODCENCUS			AND CAB.CODPROJ IN :P_PROJETO			AND SUBSTR(CAB.CODNAT,1,3) = 101		UNION ALL		SELECT			-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO					, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL						FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290			INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA			INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA			INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER			INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT			LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI		WHERE 			CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN			AND TPO.GOLSINAL = -1			AND CAB.STATUSNOTA = 'L'			AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))			AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')			AND ITE.SEQUENCIA > 0			AND CAB.CODEMP IN :P_CODEMP			AND CAB.CODCENCUS IN :P_CODCENCUS			AND CAB.CODPROJ IN :P_PROJETO			AND SUBSTR(CAB.CODNAT,1,3) = 101 								)V 			GROUP BY 1,2,3  	UNION ALL/*****************************************************************************************************************************/* CUSTO COMPRAS/CMV - DOS PORTAIS  */	SELECT 		4000 AS CODNAT		, 'CMV - CUSTO DA MERCADORIA VENDIDA ' DESCRNAT		, 5 AS ORDEM		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JANEIRO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS FEVEREIRO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MARCO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MAIO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JUNHO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JULHO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS AGOSTO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS SETEMBRO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS OUTUBRO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS NOVEMBRO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		        , -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS DEZEMBRO            , ROUND(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP  	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12		        , -ABS(SUM( (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  ))    AS TOTAL            , ROUND(SUM( (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFCAB CAB 		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI 	WHERE 	CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND TPO.GOLSINAL = -1	AND CAB.STATUSNOTA = 'L'	AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))	AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')	AND ITE.SEQUENCIA > 0	AND CAB.CODEMP IN :P_CODEMP	AND CAB.CODCENCUS IN :P_CODCENCUS	AND CAB.CODPROJ IN :P_PROJETO	AND SUBSTR(CAB.CODNAT,1,3) = 101	GROUP BY 1	UNION ALL 	/*****************************************************************************************************************************/* RESULTADO BRUTA */	SELECT 		40000		, '( = ) MARGEM BRUTA ' 		, 6 AS ORDEM		,SUM(JANEIRO) AS JANEIRO 			,ROUND(SUM(JANEIRO) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		,SUM(FEVEREIRO) AS FEVEREIRO			,ROUND(SUM(FEVEREIRO) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		,SUM(MARCO) AS MARCO 			,ROUND(SUM(MARCO) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		,SUM(ABRIL) AS ABRIL 			,ROUND(SUM(ABRIL) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4		,SUM(MAIO) AS MAIO			,ROUND(SUM(MAIO) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5		,SUM(JUNHO) AS JUNHO 			,ROUND(SUM(JUNHO) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		,SUM(JULHO) AS JULHO 			,ROUND(SUM(JULHO) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		,SUM(AGOSTO) AS AGOSTO 			,ROUND(SUM(AGOSTO) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		,SUM(SETEMBRO) AS SETEMBRO 			,ROUND(SUM(SETEMBRO) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		,SUM(OUTUBRO) AS OUTUBRO 			,ROUND(SUM(OUTUBRO) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		,SUM(NOVEMBRO) AS NOVEMBRO 			,ROUND(SUM(NOVEMBRO) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		,SUM(DEZEMBRO) AS DEZEMBRO 			,ROUND(SUM(DEZEMBRO) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12		,SUM(TOTAL) AS TOTAL  			,ROUND(SUM(TOTAL) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM (		/* RECEITA*/		SELECT 			SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO			, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO					, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTAL		FROM TGFCAB CAB 			INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER			INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA			INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 			INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT			LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI		 		WHERE 			CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN			AND TPO.GOLSINAL = -1			AND CAB.STATUSNOTA = 'L'			AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))			AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')			AND ITE.SEQUENCIA > 0			AND CAB.CODEMP IN :P_CODEMP			AND CAB.CODCENCUS IN :P_CODCENCUS			AND CAB.CODPROJ IN :P_PROJETO			AND SUBSTR(CAB.CODNAT,1,3) = 101		UNION ALL				/* SUBTRAI OS IMPOSTOS*/		SELECT			-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO					, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL						FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290			INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA			INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA			INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER			INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT			LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI		WHERE 			CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN			AND TPO.GOLSINAL = -1			AND CAB.STATUSNOTA = 'L'			AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))			AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')			AND ITE.SEQUENCIA > 0			AND CAB.CODEMP IN :P_CODEMP			AND CAB.CODCENCUS IN :P_CODCENCUS			AND CAB.CODPROJ IN :P_PROJETO			AND SUBSTR(CAB.CODNAT,1,3) = 101 		UNION ALL 				/* SUBTRAI O CMV*/		SELECT    			-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JANEIRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS FEVEREIRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MARCO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS ABRIL			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MAIO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JUNHO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JULHO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS AGOSTO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS SETEMBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS OUTUBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS NOVEMBRO			, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS DEZEMBRO			, -ABS(SUM( (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  ))   AS TOTAL				FROM TGFCAB CAB			INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER			INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA			INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 			INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT			LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI			 		WHERE 			CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN			AND TPO.GOLSINAL = -1			AND CAB.STATUSNOTA = 'L'			AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))			AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')			AND ITE.SEQUENCIA > 0			AND CAB.CODEMP IN :P_CODEMP			AND CAB.CODCENCUS IN :P_CODCENCUS			AND CAB.CODPROJ IN :P_PROJETO			AND SUBSTR(CAB.CODNAT,1,3) = 101						)V 				GROUP BY 1 	UNION ALL/*****************************************************************************************************************************/* TOTAL GRUPO DE DESEPSAS ADMINISTRATIVAS */	SELECT		3000		, 'DESPESA OPERACIONAL'		, 7 AS ORDEM		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4         		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5          		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12          		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL			, ROUND(SUM((FIN.VLRDESDOB * FIN.RECDESP) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	WHERE 		FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(3)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)			GROUP BY 1	UNION ALL  /*****************************************************************************************************************************/* DETALHAMENTO DESPESA DESEPSAS ADMINISTRATIVAS */	SELECT		PAI.CODNAT		, PAI.DESCRNAT		, 8 AS ORDEM		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4         		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5          		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12          		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL			, ROUND(SUM((FIN.VLRDESDOB * FIN.RECDESP) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	WHERE 		FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,3) IN(301,302,303,304,305)	GROUP BY		PAI.CODNAT		, PAI.DESCRNAT	UNION ALL /*****************************************************************************************************************************/* TOTAL GRUPO DE DESEPSAS COMERCIAIS */	SELECT		3000		, 'DESPESA OPERACIONAL'		, 9 AS ORDEM		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4         		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5          		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12          		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL			, ROUND(SUM((FIN.VLRDESDOB * FIN.RECDESP) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	WHERE 		FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(4)			GROUP BY 1	UNION ALL  /*****************************************************************************************************************************/* DETALHAMENTO DESPESA DESEPSAS COMERCIAIS */	SELECT		PAI.CODNAT		, PAI.DESCRNAT		, 10 AS ORDEM		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4         		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5          		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12          		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL			, ROUND(SUM((FIN.VLRDESDOB * FIN.RECDESP) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	WHERE 		FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,3) IN(401,402,403)	GROUP BY		PAI.CODNAT		, PAI.DESCRNAT	UNION ALL /*****************************************************************************************************************************/* RESULTADO OPERACIONAL */SELECT 	50000 CODNAT	, '( = ) RESULTADO OPERACIONAL' 	, 11 AS ORDEM	,SUM(JANEIRO) AS JANEIRO 		,ROUND(SUM(JANEIRO) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1	,SUM(FEVEREIRO) AS FEVEREIRO		,ROUND(SUM(FEVEREIRO) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2	,SUM(MARCO) AS MARCO 		,ROUND(SUM(MARCO) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3	,SUM(ABRIL) AS ABRIL 		,ROUND(SUM(ABRIL) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4	,SUM(MAIO) AS MAIO		,ROUND(SUM(MAIO) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5	,SUM(JUNHO) AS JUNHO 		,ROUND(SUM(JUNHO) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6	,SUM(JULHO) AS JULHO 		,ROUND(SUM(JULHO) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7	,SUM(AGOSTO) AS AGOSTO 		,ROUND(SUM(AGOSTO) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8	,SUM(SETEMBRO) AS SETEMBRO 		,ROUND(SUM(SETEMBRO) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9	,SUM(OUTUBRO) AS OUTUBRO 		,ROUND(SUM(OUTUBRO) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10	,SUM(NOVEMBRO) AS NOVEMBRO 		,ROUND(SUM(NOVEMBRO) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11	,SUM(DEZEMBRO) AS DEZEMBRO 		,ROUND(SUM(DEZEMBRO) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12	,SUM(TOTAL) AS TOTAL  		,ROUND(SUM(TOTAL) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13FROM (	/* RECEITA*/	SELECT 		SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO				, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTAL	FROM TGFCAB CAB 		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	 	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101	UNION ALL	/* SUBTRAI OS IMPOSTOS*/	SELECT		-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO				, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL				FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290		INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA		INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 	UNION ALL 	/* SUBTRAI O CMV*/	SELECT    		-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JANEIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS FEVEREIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MARCO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS ABRIL		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MAIO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JUNHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JULHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS AGOSTO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS SETEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS OUTUBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS NOVEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS DEZEMBRO		, -ABS(SUM( (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  ))   AS TOTAL	FROM TGFCAB CAB		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI		 	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 				UNION ALL 			/* SUBTRAI AS DESPESAS */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)	) 		GROUP BY 1 	UNION ALL /*****************************************************************************************************************************/* OUTROS GRUPOS - RESULTADO FINANCEIRO */	SELECT		PAI.CODNAT		, PAI.DESCRNAT		, 12 AS ORDEM		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4         		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5          		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12          		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL			, ROUND(SUM((FIN.VLRDESDOB * FIN.RECDESP) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	WHERE 		FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,3) IN(306)	GROUP BY		PAI.CODNAT		, PAI.DESCRNAT		UNION ALL 			/*****************************************************************************************************************************/* OUTROS GRUPOS - RESULTADO FINANCEIRO */	SELECT		PAI.CODNAT		, 'OUTROS GASTOS ' AS DESCRNAT		, 13 AS ORDEM		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4         		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5          		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12          		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL			, ROUND(SUM((FIN.VLRDESDOB * FIN.RECDESP) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	WHERE 		FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)	GROUP BY		PAI.CODNAT	UNION ALL	/*****************************************************************************************************************************/* RESULTAOD ANTES DO IRPJ E DO CSLL */SELECT 	50000 CODNAT	, '( = ) RESULTADO ANTES DO IRPJ E CSLL' 	, 14 AS ORDEM	,SUM(JANEIRO) AS JANEIRO 		,ROUND(SUM(JANEIRO) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1	,SUM(FEVEREIRO) AS FEVEREIRO		,ROUND(SUM(FEVEREIRO) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2	,SUM(MARCO) AS MARCO 		,ROUND(SUM(MARCO) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3	,SUM(ABRIL) AS ABRIL 		,ROUND(SUM(ABRIL) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4	,SUM(MAIO) AS MAIO		,ROUND(SUM(MAIO) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5	,SUM(JUNHO) AS JUNHO 		,ROUND(SUM(JUNHO) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6	,SUM(JULHO) AS JULHO 		,ROUND(SUM(JULHO) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7	,SUM(AGOSTO) AS AGOSTO 		,ROUND(SUM(AGOSTO) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8	,SUM(SETEMBRO) AS SETEMBRO 		,ROUND(SUM(SETEMBRO) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9	,SUM(OUTUBRO) AS OUTUBRO 		,ROUND(SUM(OUTUBRO) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10	,SUM(NOVEMBRO) AS NOVEMBRO 		,ROUND(SUM(NOVEMBRO) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11	,SUM(DEZEMBRO) AS DEZEMBRO 		,ROUND(SUM(DEZEMBRO) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12	,SUM(TOTAL) AS TOTAL  		,ROUND(SUM(TOTAL) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13FROM (	/* RECEITA*/	SELECT 		SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO				, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTAL	FROM TGFCAB CAB 		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	 	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101	UNION ALL	/* SUBTRAI OS IMPOSTOS*/	SELECT		-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO				, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL				FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290		INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA		INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 	UNION ALL 	/* SUBTRAI O CMV*/	SELECT    		-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JANEIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS FEVEREIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MARCO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS ABRIL		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MAIO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JUNHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JULHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS AGOSTO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS SETEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS OUTUBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS NOVEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS DEZEMBRO		, -ABS(SUM( (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  ))   AS TOTAL	FROM TGFCAB CAB		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI		 	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 				UNION ALL 		/* SUBTRAI AS DESPESAS */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)			UNION ALL 		/* SUBTRAI AS FINANCEIRAS */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,3) IN(306)					UNION ALL 		/* SUBTRAI OUTRAS DESPESAS */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)	) 		GROUP BY 1		UNION ALL/*****************************************************************************************************************************/* IRPJ E CSLL */	SELECT		FIN.CODNAT		, NAT.DESCRNAT AS DESCRNAT		, 15 AS ORDEM		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4         		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5          		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, ROUND(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12          		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL			, ROUND(SUM((FIN.VLRDESDOB * FIN.RECDESP) ) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13	FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	WHERE 		FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)	GROUP BY		FIN.CODNAT		, NAT.DESCRNAT					UNION ALL	/*****************************************************************************************************************************/* RESULTAOD PÓS IRPJ E CSLL */SELECT 	50000 CODNAT	, '( = ) RESULTADO LÍQUIDDO' 	, 16 AS ORDEM	,SUM(JANEIRO) AS JANEIRO 		,ROUND(SUM(JANEIRO) / (SELECT CASE WHEN JANEIRO = 0 THEN 1 ELSE JANEIRO END FROM COMPARATIVO) *100,1) AS AV1	,SUM(FEVEREIRO) AS FEVEREIRO		,ROUND(SUM(FEVEREIRO) / (SELECT CASE WHEN FEVEREIRO = 0 THEN 1 ELSE FEVEREIRO END FROM COMPARATIVO) *100,1) AS AV2	,SUM(MARCO) AS MARCO 		,ROUND(SUM(MARCO) / (SELECT CASE WHEN MARCO = 0 THEN 1 ELSE MARCO END FROM COMPARATIVO) *100,1) AS AV3	,SUM(ABRIL) AS ABRIL 		,ROUND(SUM(ABRIL) / (SELECT CASE WHEN ABRIL = 0 THEN 1 ELSE ABRIL END FROM COMPARATIVO) *100,1) AS AV4	,SUM(MAIO) AS MAIO		,ROUND(SUM(MAIO) / (SELECT CASE WHEN MAIO = 0 THEN 1 ELSE MAIO END FROM COMPARATIVO) *100,1) AS AV5	,SUM(JUNHO) AS JUNHO 		,ROUND(SUM(JUNHO) / (SELECT CASE WHEN JUNHO = 0 THEN 1 ELSE JUNHO END FROM COMPARATIVO) *100,1) AS AV6	,SUM(JULHO) AS JULHO 		,ROUND(SUM(JULHO) / (SELECT CASE WHEN JULHO = 0 THEN 1 ELSE JULHO END FROM COMPARATIVO) *100,1) AS AV7	,SUM(AGOSTO) AS AGOSTO 		,ROUND(SUM(AGOSTO) / (SELECT CASE WHEN AGOSTO = 0 THEN 1 ELSE AGOSTO END FROM COMPARATIVO) *100,1) AS AV8	,SUM(SETEMBRO) AS SETEMBRO 		,ROUND(SUM(SETEMBRO) / (SELECT CASE WHEN SETEMBRO = 0 THEN 1 ELSE SETEMBRO END FROM COMPARATIVO) *100,1) AS AV9	,SUM(OUTUBRO) AS OUTUBRO 		,ROUND(SUM(OUTUBRO) / (SELECT CASE WHEN OUTUBRO = 0 THEN 1 ELSE OUTUBRO END FROM COMPARATIVO) *100,1) AS AV10	,SUM(NOVEMBRO) AS NOVEMBRO 		,ROUND(SUM(NOVEMBRO) / (SELECT CASE WHEN NOVEMBRO = 0 THEN 1 ELSE NOVEMBRO END FROM COMPARATIVO) *100,1) AS AV11	,SUM(DEZEMBRO) AS DEZEMBRO 		,ROUND(SUM(DEZEMBRO) / (SELECT CASE WHEN DEZEMBRO = 0 THEN 1 ELSE DEZEMBRO END FROM COMPARATIVO) *100,1) AS AV12	,SUM(TOTAL) AS TOTAL  		,ROUND(SUM(TOTAL) / (SELECT CASE WHEN TOTAL = 0 THEN 1 ELSE TOTAL END FROM COMPARATIVO) *100,1) AS AV13FROM (	/* RECEITA*/	SELECT 		SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO				, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTAL	FROM TGFCAB CAB 		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	 	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101	UNION ALL	/* SUBTRAI OS IMPOSTOS*/	SELECT		-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO				, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL				FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290		INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA		INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 	UNION ALL 	/* SUBTRAI O CMV*/	SELECT    		-ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JANEIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS FEVEREIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MARCO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS ABRIL		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS MAIO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JUNHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS JULHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS AGOSTO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS SETEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS OUTUBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS NOVEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END))  AS DEZEMBRO		, -ABS(SUM( (  NVL(((SELECT MAX(CUS.CUSREP)    FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP    AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  ))   AS TOTAL	FROM TGFCAB CAB		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA		INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI		 	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 				UNION ALL 		/* SUBTRAI AS DESPESAS */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)			UNION ALL 		/* SUBTRAI AS FINANCEIRAS */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,3) IN(306)					UNION ALL 		/* SUBTRAI OUTRAS DESPESAS */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)			UNION ALL 		/* SUBTRAI IRPJ E CSLL */	 	SELECT 	  -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JANEIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS FEVEREIRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MARCO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS ABRIL	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS MAIO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JUNHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS JULHO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS AGOSTO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS SETEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS OUTUBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS NOVEMBRO	, -ABS(SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END)) AS DEZEMBRO	, -ABS(SUM((FIN.VLRDESDOB * FIN.RECDESP) )) AS TOTAL		 FROM TGFFIN FIN		INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC		INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI			 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'		AND FIN.CODCENCUS IN :P_CODCENCUS		AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODEMP IN :P_CODEMP		AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)	) 		GROUP BY 1	 )ZWHERE TOTAL <> 0 ORDER BY ORDEM,CODNAT]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="F" visible="true" useFooter="false" mask="###0"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="ORDEM" label="Ordem" type="F" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Janeiro" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV1" label="AV1" type="F" visible="true" useFooter="false"/>
            <field name="FEVEREIRO" label="Fevereiro" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV2" label="AV2" type="F" visible="true" useFooter="false"/>
            <field name="MARCO" label="Março" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV3" label="AV3" type="F" visible="true" useFooter="false"/>
            <field name="ABRIL" label="Abril" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV4" label="AV4" type="F" visible="true" useFooter="false"/>
            <field name="MAIO" label="Maio" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV5" label="AV5" type="F" visible="true" useFooter="false"/>
            <field name="JUNHO" label="Junho" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV6" label="AV6" type="F" visible="true" useFooter="false"/>
            <field name="JULHO" label="Julho" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV7" label="AV7" type="F" visible="true" useFooter="false"/>
            <field name="AGOSTO" label="Agosto" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV8" label="AV8" type="F" visible="true" useFooter="false"/>
            <field name="SETEMBRO" label="Setembro" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV9" label="AV9" type="F" visible="true" useFooter="false"/>
            <field name="OUTUBRO" label="Outubro" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV10" label="AV10" type="F" visible="true" useFooter="false"/>
            <field name="NOVEMBRO" label="Novembro" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV11" label="AV11" type="F" visible="true" useFooter="false"/>
            <field name="DEZEMBRO" label="Dezembro" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV12" label="AV12" type="F" visible="true" useFooter="false"/>
            <field name="TOTAL" label="Total" type="F" visible="true" useFooter="false" mask="#.##0;(n)"/>
            <field name="AV13" label="AV13" type="F" visible="true" useFooter="false"/>
            <field name="BKCOLOR" label="BKCOLOR" type="S" visible="false" useFooter="false"/>
            <field name="FGCOLOR" label="FGCOLOR" type="S" visible="false" useFooter="false"/>
          </metadata>
          <on-click navigate-to="lvl_a6616yh">
            <param id="A_CODNAT"/>
            <param id="A_ORDEM"/>
            <param id="DESPESAS"/>
          </on-click>
        </grid>
      </container>
      <container orientacao="H" tamanhoRelativo="3700">
        <container orientacao="V" tamanhoRelativo="50">
          <simple-value id="svl_a42afgu">
            <value-expression><![CDATA[<table border="1" style="width: 100%; border-collapse: collapse; border-style: solid; background-color: #2a7369;"><tbody><tr><td style="width: 100%; text-align: center;"><span style="color: #ffffff;"><strong><span style='font-size: 12px;'>Detalhes Receitas e Deduções</span></strong></span></td></tr></tbody></table>]]></value-expression>
            <on-click navigate-to="lvl_a6616yv"/>
          </simple-value>
        </container>
        <container orientacao="V" tamanhoRelativo="50">
          <simple-value id="svl_h9fqea">
            <value-expression><![CDATA[<table border="1" style="width: 100%; border-collapse: collapse; border-style: solid; background-color: #2a7369;"><tbody><tr><td style="width: 100%; text-align: center;"><span style="color: #ffffff;"><strong><span style='font-size: 12px;'>Destalhes CMV - Custo da Mercadoria Vendida</span></strong></span></td></tr></tbody></table>]]></value-expression>
            <on-click navigate-to="lvl_h9fqgj"/>
          </simple-value>
        </container>
      </container>
      <container orientacao="H" tamanhoRelativo="3600">
        <container orientacao="V" tamanhoRelativo="50">
          <simple-value id="svl_d7g8pv">
            <value-expression><![CDATA[<span style='font-size: 14px;'><table border="1" style="width: 100%; border-collapse: collapse; border-style: solid; background-color: #2a7369;"><tbody><tr><td style="width: 100%; text-align: center;"><span style="color: #ffffff;"><strong><span style='font-size: 12px;'>Detalhes Despesas Operacionais</span></strong></span></td></tr></tbody></table></span>]]></value-expression>
            <on-click navigate-to="lvl_d7g8pw"/>
          </simple-value>
        </container>
        <container orientacao="V" tamanhoRelativo="50">
          <simple-value id="svl_h9fqcx">
            <value-expression><![CDATA[<table border="1" style="width: 100%; border-collapse: collapse; border-style: solid; background-color: #2a7369;"><tbody><tr><td style="width: 100%; text-align: center;"><span style="color: #ffffff;"><strong><span style='font-size: 12px;'>Detalhes Financeiras e Outros</span></strong></span></td></tr></tbody></table>]]></value-expression>
            <on-click navigate-to="lvl_h9fqmq"/>
          </simple-value>
        </container>
      </container>
    </container>
  </level>
  <level id="lvl_a6616yv" description="Análitico Receitas">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_a6616yx" multiplaSelecao="S" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT NAT.CODNAT		,  NAT.DESCRNAT		, 1 AS ORDEM_INTERNA		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END) AS DEZEMBRO		, SUM( ( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ) AS TOTAL FROM TGFCAB CAB INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER                INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA                INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 				INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI  WHERE    CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN    AND TPO.GOLSINAL = -1    AND CAB.STATUSNOTA = 'L'    AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))    AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')    AND ITE.SEQUENCIA > 0	AND CAB.CODEMP IN :P_CODEMP    AND CAB.CODCENCUS IN :P_CODCENCUS    AND CAB.CODPROJ IN :P_PROJETO    AND SUBSTR(CAB.CODNAT,1,3) IN (101)GROUP BY    NAT.CODNAT	, NAT.DESCRNAT	UNION ALL	SELECT		DIN.CODIMP		,  CASE WHEN DIN.CODIMP = 1 THEN 'ICMS' WHEN DIN.CODIMP = 2 THEN 'ICMS ST' WHEN DIN.CODIMP = 3 THEN 'IPI' WHEN DIN.CODIMP = 6 THEN 'PIS' WHEN DIN.CODIMP = 7 THEN 'COFINS' ELSE 'OUTROS' END AS DESCRNAT		, 3 AS ORDEM		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JANEIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS FEVEREIRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MARCO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS ABRIL		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS MAIO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JUNHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS JULHO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS AGOSTO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS SETEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS OUTUBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS NOVEMBRO		, -ABS(SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  ( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ) ELSE 0 END)) AS DEZEMBRO				, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS TOTAL	FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290		INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA		INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101 	GROUP BY		DIN.CODIMP		, CASE WHEN DIN.CODIMP = 1 THEN 'ICMS' WHEN DIN.CODIMP = 2 THEN 'ICMS ST' WHEN DIN.CODIMP = 3 THEN 'IPI' WHEN DIN.CODIMP = 6 THEN 'PIS' WHEN DIN.CODIMP = 7 THEN 'COFINS' ELSE 'OUTROS' ENDORDER BY 3, 1]]></expression>
          <metadata>
            <field name="CODNAT" label="Cod. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="ORDEM_INTERNA" label="Ordem Interna" type="F" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Jan" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="FEVEREIRO" label="Fev" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MARCO" label="Mar" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="ABRIL" label="Abr" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MAIO" label="Mai" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="JUNHO" label="Jun" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="JULHO" label="Jul" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="AGOSTO" label="Ago" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="SETEMBRO" label="Sete" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="OUTUBRO" label="Outu" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="NOVEMBRO" label="Nov" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="DEZEMBRO" label="Dez" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          </metadata>
          <refresh-details ui-list="cht_a3adykd">
            <param id="A_CODNAT">$CODNAT</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_a3adykd" type="column">
          <args>
            <arg id="A_CODNAT" type="integer"/>
          </args>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT     X.CODNAT    , X.DESCRNAT    , X.MES    , SUM(X.VLRNOTA) AS VLRNOTAFROM    (    SELECT         NAT.CODNAT        , NAT.DESCRNAT        , EXTRACT(MONTH FROM CAB.DTNEG) AS MES        , SUM(( ((ITE.VLRTOT - ITE.VLRDESC - ITE.VLRREPRED + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV )) VLRNOTA        FROM TGFCAB CAB         INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER        INNER JOIN TGFPAR PAR ON PAR.CODPARC = CAB.CODPARC        INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA        INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA         INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT        LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI        LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI        WHERE        CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN        AND TPO.GOLSINAL = -1        AND CAB.STATUSNOTA = 'L'        AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))        AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')        AND ITE.SEQUENCIA > 0        AND CAB.CODEMP IN :P_CODEMP        AND CAB.CODCENCUS IN :P_CODCENCUS        AND CAB.CODPROJ IN :P_PROJETO        AND SUBSTR(CAB.CODNAT,1,3) = 101        AND NAT.CODNAT IN :A_CODNAT        GROUP BY        NAT.CODNAT        , NAT.DESCRNAT        , CAB.DTNEG            UNION ALL        	SELECT		DIN.CODIMP AS CODNAT		,  CASE WHEN DIN.CODIMP = 1 THEN 'ICMS' WHEN DIN.CODIMP = 2 THEN 'ICMS ST' WHEN DIN.CODIMP = 3 THEN 'IPI' WHEN DIN.CODIMP = 6 THEN 'PIS' WHEN DIN.CODIMP = 7 THEN 'COFINS' ELSE 'OUTROS' END AS DESCRNAT        , EXTRACT(MONTH FROM CAB.DTNEG) AS MES			, -ABS(SUM(( (DIN.VALOR) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV ))) AS VLRNOTA	FROM TGFCAB CAB  --WHERE DIN.NUNOTA = 48290		INNER JOIN TGFITE ITE ON ITE.NUNOTA = CAB.NUNOTA		INNER JOIN TGFDIN DIN ON DIN.NUNOTA = ITE.NUNOTA AND DIN.SEQUENCIA = ITE.SEQUENCIA		INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER		INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT		LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI		LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI	WHERE 		CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND TPO.GOLSINAL = -1		AND CAB.STATUSNOTA = 'L'		AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))		AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')		AND ITE.SEQUENCIA > 0		AND CAB.CODEMP IN :P_CODEMP		AND CAB.CODCENCUS IN :P_CODCENCUS		AND CAB.CODPROJ IN :P_PROJETO		AND SUBSTR(CAB.CODNAT,1,3) = 101         AND DIN.CODIMP IN :A_CODNAT	GROUP BY		DIN.CODIMP		, CASE WHEN DIN.CODIMP = 1 THEN 'ICMS' WHEN DIN.CODIMP = 2 THEN 'ICMS ST' WHEN DIN.CODIMP = 3 THEN 'IPI' WHEN DIN.CODIMP = 6 THEN 'PIS' WHEN DIN.CODIMP = 7 THEN 'COFINS' ELSE 'OUTROS' END		, CAB.DTNEG    )X    GROUP BY    X.CODNAT    , X.DESCRNAT    , X.MES    ORDER BY X.MES]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
            <field name="VLRNOTA" label="Vlr. Total" type="I" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
          </metadata>
          <vertical-axis>
            <linear resultRotation="0" vResizing="true">
              <mask>#.##0,00;(n)</mask>
              <showStackLabels/>
            </linear>
          </vertical-axis>
          <series>
            <serie type="column">
              <xField>$MES</xField>
              <yField>$VLRNOTA</yField>
              <display><![CDATA[Cód. Natureza:$CODNAT<br>Natureza:$DESCRNAT]]></display>
              <color>0x2a7344</color>
              <on-click navigate-to="lvl_a3adyrf">
                <param id="A_MES">$MES</param>
              </on-click>
            </serie>
          </series>
        </chart>
      </container>
    </container>
  </level>
  <level id="lvl_a3adyrf" description="Análitico 2 Receitas">
    <args>
      <arg id="A_MES" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_a3adyru" useNewGrid="S">
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT    CAB.CODEMP    , NAT.CODNAT    , NAT.DESCRNAT    , CAB.NUNOTA    , CAB.NUMNOTA    , CAB.CODPARC    , PAR.RAZAOSOCIAL    , CAB.DTNEG    , EXTRACT(MONTH FROM CAB.DTNEG) AS MES    , CAB.CODPROJ    , CAB.CODCENCUS    , SUM(CAB.VLRNOTA) AS VLRNOTA    , -ABS(SUM( NVL( ((SELECT SUM(ICMS.VALOR) FROM TGFDIN ICMS WHERE ICMS.CODIMP = 1 AND ICMS.NUNOTA = CAB.NUNOTA) * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV) ,0) )) AS VLRICMS     , -ABS(SUM( NVL( ((SELECT SUM(ICMSST.VALOR) FROM TGFDIN ICMSST WHERE ICMSST.CODIMP = 2 AND ICMSST.NUNOTA = CAB.NUNOTA)  * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV) ,0) )) AS VLRICMST     , -ABS(SUM( NVL( ((SELECT SUM(IPI.VALOR) FROM TGFDIN IPI WHERE IPI.CODIMP = 3 AND IPI.NUNOTA = CAB.NUNOTA)  * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV) ,0) )) AS VLRIPI     , -ABS(SUM( NVL( ((SELECT SUM(PIS.VALOR) FROM TGFDIN PIS WHERE PIS.CODIMP = 6 AND PIS.NUNOTA = CAB.NUNOTA)  * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV) ,0) )) AS VLRPIS     , -ABS(SUM( NVL( ((SELECT SUM(COFINS.VALOR) FROM TGFDIN COFINS WHERE COFINS.CODIMP = 7 AND COFINS.NUNOTA = CAB.NUNOTA)  * CASE WHEN TPO.BONIFICACAO = 'S' THEN 0 ELSE 1 END * TPO.GOLDEV) ,0) )) AS VLRCOFINS 	FROM TGFCAB CAB    INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER    INNER JOIN TGFPAR PAR ON PAR.CODPARC = CAB.CODPARC    INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA     INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT    LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI    LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAIWHERE     CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN    AND TPO.GOLSINAL = -1    AND CAB.STATUSNOTA = 'L'    AND CAB.CODEMP IN :P_CODEMP    AND CAB.CODCENCUS IN :P_CODCENCUS    AND CAB.CODPROJ IN :P_PROJETO    AND SUBSTR(CAB.CODNAT,1,3) = 101    AND EXTRACT(MONTH FROM CAB.DTNEG) = :A_MESGROUP BY     CAB.CODEMP    , NAT.CODNAT    , NAT.DESCRNAT    , CAB.NUNOTA    , CAB.NUMNOTA    , CAB.CODPARC    , PAR.RAZAOSOCIAL    , CAB.DTNEG    , EXTRACT(MONTH FROM CAB.DTNEG)    , CAB.CODPROJ    , CAB.CODCENCUS    , CAB.VLRNOTA]]></expression>
        <metadata>
          <field name="CODEMP" label="Empresa" type="I" visible="true" useFooter="false"/>
          <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
          <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
          <field name="NUNOTA" label="Nro. Único" type="I" visible="true" useFooter="false"/>
          <field name="NUMNOTA" label="NFE" type="I" visible="true" useFooter="false"/>
          <field name="CODPARC" label="Cód. Paiceor" type="I" visible="true" useFooter="false"/>
          <field name="RAZAOSOCIAL" label="Razão Social" type="S" visible="true" useFooter="false"/>
          <field name="DTNEG" label="Dt. Negociação" type="D" visible="true" useFooter="false"/>
          <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          <field name="CODPROJ" label="Projeto" type="I" visible="true" useFooter="false"/>
          <field name="CODCENCUS" label="Centro de Resultado" type="I" visible="true" useFooter="false"/>
          <field name="VLRNOTA" label="Vlr. Nota" type="I" visible="true" useFooter="false"/>
          <field name="VLRICMS" label="ICMS" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="VLRICMST" label="ICMSST" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="VLRIPI" label="IPI" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="VLRPIS" label="PIS" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="VLRCOFINS" label="COFINS" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
        </metadata>
        <on-click-launcher resource-id="br.com.sankhya.com.mov.CentralNotas">
          <NUNOTA>$NUNOTA</NUNOTA>
        </on-click-launcher>
      </grid>
    </container>
  </level>
  <level id="lvl_h9fqgj" description="Análitico CMV">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_h9fqgk" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT 		 'CMV - CUSTO DA MERCADORIA VENDIDA ' DESCRNAT      , 1 AS CODNAT		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 01 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS JANEIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 02 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 03 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS MARCO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 04 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 05 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS MAIO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 06 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS JUNHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 07 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS JULHO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 08 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS AGOSTO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 09 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 10 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 11 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(CAB.DTNEG,'MM') = 12 THEN  (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP     AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV ) ELSE 0 END)  AS DEZEMBRO		, SUM( (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  )    AS TOTAL FROM TGFCAB CAB INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER                INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA                INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 				INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI  WHERE CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FINAND TPO.GOLSINAL = -1AND CAB.STATUSNOTA = 'L'AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')AND ITE.SEQUENCIA > 0AND CAB.CODEMP IN :P_CODEMPAND CAB.CODCENCUS IN :P_CODCENCUSAND CAB.CODPROJ IN :P_PROJETOAND SUBSTR(CAB.CODNAT,1,3) = 101 ]]></expression>
          <metadata>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="CODNAT" label="CODNAT" type="F" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Jan" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEVEREIRO" label="Fev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MARCO" label="Mar" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABRIL" label="Abr" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAIO" label="Mai" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUNHO" label="Jun" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JULHO" label="Jul" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGOSTO" label="Ago" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SETEMBRO" label="Sete" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUTUBRO" label="Outu" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOVEMBRO" label="Nov" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZEMBRO" label="Dez" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TOTAL" label="Total" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          </metadata>
          <refresh-details ui-list="cht_a57pzaa">
            <param id="A_CODNAT">$CODNAT</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_a57pzaa" type="column">
          <args>
            <arg id="A_CODNAT" type="integer"/>
          </args>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT * FROM         (SELECT 		'CMV - CUSTO DA MERCADORIA VENDIDA ' AS DESCRNAT		, 1 AS CODNAT		, SUM( (  NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODPROD = ITE.CODPROD  AND CUS.CODEMP = CAB.CODEMP AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) 	FROM TGFCUS CN 	WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP 	 	AND CN.CODLOCAl = CUS.CODLOCAL 	 ))  ), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  )    AS TOTAL        , EXTRACT(MONTH FROM CAB.DTNEG) AS MES                 FROM TGFCAB CAB INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER                        INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA                        INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA         				INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT        				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI        				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI                  WHERE CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN        AND TPO.GOLSINAL = -1        AND CAB.STATUSNOTA = 'L'        AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))        AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')        AND ITE.SEQUENCIA > 0        AND CAB.CODEMP IN :P_CODEMP        AND CAB.CODCENCUS IN :P_CODCENCUS        AND CAB.CODPROJ IN :P_PROJETO        AND SUBSTR(CAB.CODNAT,1,3) = 101                 GROUP BY EXTRACT(MONTH FROM CAB.DTNEG) ) ZWHERE CODNAT = :A_CODNATORDER BY 4 ASC]]></expression>
          <metadata>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="CODNAT" label="Cód. Natureza" type="F" visible="true" useFooter="false"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
            <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          </metadata>
          <vertical-axis>
            <linear resultRotation="0" vResizing="true">
              <mask>#.##0,00;(n)</mask>
            </linear>
          </vertical-axis>
          <series>
            <serie type="column">
              <xField>$MES</xField>
              <yField>$TOTAL</yField>
              <display><![CDATA[CMV]]></display>
              <color>0x2a7344</color>
              <on-click navigate-to="lvl_a57pzce">
                <param id="A_MES">$MES</param>
              </on-click>
            </serie>
          </series>
        </chart>
      </container>
    </container>
  </level>
  <level id="lvl_a57pzce" description="Análitico 2 CMV">
    <args>
      <arg id="A_MES" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_a57pzcf" useNewGrid="S">
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT ITE.NUNOTA, CAB.NUMNOTA, CAB.CODEMP,ITE.CODPROD	,(SELECT DESCRPROD FROM TGFPRO P WHERE P.CODPROD = ITE.CODPROD) AS DESCRPROD,(ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO AS VLRITEM, ITE.QTDNEG,(NVL(((SELECT CUS.CUSREP FROM TGFCUS CUS WHERE CUS.CODEMP = CAB.CODEMP AND CUS.CODPROD = ITE.CODPROD AND CUS.DTATUAL = (SELECT MAX (CN.DTATUAL) FROM TGFCUS CN WHERE CN.CODPROD = CUS.CODPROD 	AND CN.DTATUAL <= CAB.DTNEG AND CN.CODEMP = CUS.CODEMP AND CN.CODLOCAl = CUS.CODLOCAL))), (ITE.VLRTOT - ITE.VLRDESC + ITE.VLRSUBST + ITE.VLRIPI) * VCA.INDITENSBRUTO / (CASE WHEN ITE.QTDNEG=0 THEN 1 ELSE ITE.QTDNEG END) ) * ITE.QTDNEG * TPO.GOLDEV )  AS CUSTO, VCA.DTNEG, EXTRACT( MONTH FROM VCA.DTNEG) AS MES, CAB.CODPARC, (SELECT RAZAOSOCIAL FROM TGFPAR P WHERE P.CODPARC = CAB.CODPARC) AS PARCEIRO, CAB.CODTIPOPER, TPO.DESCROPER, CAB.CODNAT, NAT.DESCRNAT, EXTRACT(MONTH FROM CAB.DTNEG) AS MES		 FROM TGFCAB CAB INNER JOIN  TGFTOP TPO ON CAB.CODTIPOPER = TPO.CODTIPOPER AND CAB.DHTIPOPER = TPO.DHALTER                INNER JOIN  TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTA                INNER JOIN  VGFCAB VCA ON CAB.NUNOTA = VCA.NUNOTA 				INNER JOIN TGFNAT NAT ON NAT.CODNAT = CAB.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI				LEFT JOIN TGFNAT AVO ON AVO.CODNAT = PAI.CODNATPAI  WHERE CAB.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FINAND /*	AND FIN.CODTIPOPER IN :CODTIPOPER*/ TPO.GOLSINAL = -1AND CAB.STATUSNOTA = 'L'AND (NOT EXISTS(SELECT 1 FROM TGFVAR VAR WHERE VAR.NUNOTA = ITE.NUNOTA AND VAR.NUNOTAORIG = VAR.NUNOTA AND VAR.SEQUENCIAORIG = ITE.SEQUENCIA))AND (TPO.ATUALFINTERC <> 'N' OR TPO.ATUALESTTERC = 'N' OR  ITE.TERCEIROS <> 'S')AND ITE.SEQUENCIA > 0AND CAB.CODEMP IN :P_CODEMPAND CAB.CODCENCUS IN :P_CODCENCUSAND CAB.CODPROJ IN :P_PROJETOAND SUBSTR(CAB.CODNAT,1,3) = 101 AND EXTRACT(MONTH FROM CAB.DTNEG) = :A_MES]]></expression>
        <metadata>
          <field name="NUNOTA" label="Nro. Único" type="I" visible="true" useFooter="false"/>
          <field name="NUMNOTA" label="NFE" type="I" visible="true" useFooter="false"/>
          <field name="CODEMP" label="Empresa" type="I" visible="true" useFooter="false"/>
          <field name="CODPROD" label="Cód. Produto" type="I" visible="true" useFooter="false"/>
          <field name="DESCRPROD" label="Produto" type="S" visible="true" useFooter="false"/>
          <field name="VLRITEM" label="Vlr. Item" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="QTDNEG" label="Quantidade" type="F" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
          <field name="CUSTO" label="Custo" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="DTNEG" label="Dt. Negociação" type="D" visible="true" useFooter="false"/>
          <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          <field name="CODPARC" label="Cód. Parceiro" type="I" visible="true" useFooter="false"/>
          <field name="PARCEIRO" label="Parceiro" type="S" visible="true" useFooter="false"/>
          <field name="CODTIPOPER" label="Cód. Top" type="I" visible="true" useFooter="false"/>
          <field name="DESCROPER" label="Tipo de Operação" type="S" visible="true" useFooter="false"/>
          <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
          <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
        </metadata>
        <on-click-launcher resource-id="br.com.sankhya.com.mov.CentralNotas">
          <NUNOTA>$NUNOTA</NUNOTA>
        </on-click-launcher>
      </grid>
    </container>
  </level>
  <level id="lvl_d7g8pw" description="Análitico Despesas">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_d7g8px" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT		, (CASE WHEN PAI.CODNAT = 10030000 THEN 'SIMPLES NACIONAL ' ELSE PAI.DESCRNAT END) AS DESCRNAT		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO	AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)	AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)	--AND PAI.GRAU <> 1	 GROUP BY  PAI.CODNAT		, PAI.DESCRNAT ORDER BY 1]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Jan" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="FEVEREIRO" label="Fev" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MARCO" label="Mar" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="ABRIL" label="Abr" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MAIO" label="Mai" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="JUNHO" label="Jun" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="JULHO" label="Jul" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="AGOSTO" label="Ago" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="SETEMBRO" label="Sete" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="OUTUBRO" label="Outu" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="NOVEMBRO" label="Nov" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="DEZEMBRO" label="Dez" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="TOTAL" label="Total" type="F" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          </metadata>
          <on-click navigate-to="lvl_a57pzo0">
            <param id="A_CODNAT">$CODNAT</param>
          </on-click>
          <refresh-details ui-list="cht_a57pzgk">
            <param id="A_CODNAT">$CODNAT</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_a57pzgk" type="column">
          <args>
            <arg id="A_CODNAT" type="integer"/>
          </args>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT		, (CASE WHEN PAI.CODNAT = 10030000 THEN 'SIMPLES NACIONAL ' ELSE PAI.DESCRNAT END) AS DESCRNAT		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO	   AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)  	AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)	AND PAI.CODNAT = :A_CODNAT	 GROUP BY  PAI.CODNAT		, PAI.DESCRNAT		, EXTRACT(MONTH FROM FIN.DTNEG) ORDER BY 1, 4]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
            <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          </metadata>
          <vertical-axis>
            <linear resultRotation="0" vResizing="true">
              <mask>#.##0,00;(n)</mask>
            </linear>
          </vertical-axis>
          <series>
            <serie type="column">
              <xField>$MES</xField>
              <yField>$TOTAL</yField>
              <display><![CDATA[Cód. Natureza:$CODNAT<br>Natureza:$DESCRNAT]]></display>
              <color>0x2a7344</color>
              <on-click navigate-to="lvl_a57pzf0">
                <param id="A_CODNAT">$CODNAT</param>
                <param id="A_MES">$MES</param>
              </on-click>
            </serie>
          </series>
        </chart>
      </container>
    </container>
  </level>
  <level id="lvl_a57pzf0" description="Analítico 2 Despesas">
    <args>
      <arg id="A_CODNAT" type="integer"/>
      <arg id="A_MES" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_a57pzf1" useNewGrid="S">
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)		AND PAI.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MES		--AND PAI.GRAU <> 1		]]></expression>
        <metadata>
          <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
          <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
          <field name="NUFIN" label="Nro. Único" type="I" visible="true" useFooter="false"/>
          <field name="NUMNOTA" label="NFE" type="I" visible="true" useFooter="false"/>
          <field name="CODPARC" label="Cód. Parceiro" type="I" visible="true" useFooter="false"/>
          <field name="RAZAOSOCIAL" label="Razão Social" type="S" visible="true" useFooter="false"/>
          <field name="DTNEG" label="Dt. Negociação" type="D" visible="true" useFooter="false"/>
          <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          <field name="DHBAIXA" label="Dh. Baixa" type="D" visible="true" useFooter="false"/>
          <field name="VLR" label="Vlr Total" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="HISTORICO" label="Historico" type="S" visible="true" useFooter="false"/>
        </metadata>
        <on-click-launcher resource-id="br.com.sankhya.fin.cad.movimentacaoFinanceira">
          <NUFIN>$NUFIN</NUFIN>
        </on-click-launcher>
      </grid>
    </container>
  </level>
  <level id="lvl_a57pzo0" description="Analítico 3 Despesas">
    <args>
      <arg id="A_CODNAT" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_a57pzqj" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT FIN.CODNAT		, NAT.DESCRNAT		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)    AND PAI.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNAT ORDER BY 1]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Jan" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="FEVEREIRO" label="Fev" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MARCO" label="Mar" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="ABRIL" label="Abr" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MAIO" label="Mai" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="JUNHO" label="Jun" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="JULHO" label="Jul" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="AGOSTO" label="Ago" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="SETEMBRO" label="Sete" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="OUTUBRO" label="Outu" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="NOVEMBRO" label="Nov" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="DEZEMBRO" label="Dez" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          </metadata>
          <refresh-details ui-list="cht_a57pzxt">
            <param id="A_CODNAT">$CODNAT</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_a57pzxt" type="column">
          <args>
            <arg id="A_CODNAT" type="integer"/>
          </args>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT   FIN.CODNAT		, NAT.DESCRNAT		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL        , EXTRACT(MONTH FROM FIN.DTNEG) AS MES FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)    AND FIN.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNAT		, EXTRACT(MONTH FROM FIN.DTNEG) ORDER BY 4]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
            <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          </metadata>
          <vertical-axis>
            <linear resultRotation="0" vResizing="true">
              <mask>#.##0,00;(n)</mask>
            </linear>
          </vertical-axis>
          <series>
            <serie type="column">
              <xField>$MES</xField>
              <yField>$TOTAL</yField>
              <display><![CDATA[Cód. Natureza:$CODNAT<br>Natureza:$DESCRNAT]]></display>
              <color>0x2a7344</color>
              <on-click navigate-to="lvl_a57pz0m">
                <param id="A_CODNAT">$CODNAT</param>
                <param id="A_MES">$MES</param>
              </on-click>
            </serie>
          </series>
        </chart>
      </container>
    </container>
  </level>
  <level id="lvl_a57pz0m" description="Analítico 4 Despesas">
    <args>
      <arg id="A_CODNAT" type="integer"/>
      <arg id="A_MES" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_a57pz07" useNewGrid="S">
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(3,4)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN(306)		AND NAT.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MES		--AND PAI.GRAU <> 1		]]></expression>
        <metadata>
          <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
          <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
          <field name="NUFIN" label="Nro. Único" type="I" visible="true" useFooter="false"/>
          <field name="NUMNOTA" label="NFE" type="I" visible="true" useFooter="false"/>
          <field name="CODPARC" label="Cód. Parceiro" type="I" visible="true" useFooter="false"/>
          <field name="RAZAOSOCIAL" label="Razão Social" type="S" visible="true" useFooter="false"/>
          <field name="DTNEG" label="Dt. Negociação" type="D" visible="true" useFooter="false"/>
          <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          <field name="DHBAIXA" label="Dh. Baixa" type="D" visible="true" useFooter="false"/>
          <field name="VLR" label="Vlr. Total" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="HISTORICO" label="Historico" type="S" visible="true" useFooter="false"/>
        </metadata>
        <on-click-launcher resource-id="br.com.sankhya.fin.cad.movimentacaoFinanceira">
          <NUFIN>$NUFIN</NUFIN>
        </on-click-launcher>
      </grid>
    </container>
  </level>
  <level id="lvl_h9fqmq" description="Análitico Invest. e Emprést.">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_h9fqmr" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT			, PAI.DESCRNAT			, 10 AS ORDEM			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,3) IN(306)			 GROUP BY  PAI.CODNAT			, PAI.DESCRNAT			UNION ALLSELECT PAI.CODNAT			, 'OUTROS GASTOS ' AS DESCRNAT			, 10 AS ORDEM			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)			 GROUP BY  PAI.CODNAT			, PAI.DESCRNAT			UNION ALLSELECT PAI.CODNAT			, 'IRPJ E CSLL' AS DESCRNAT			, 10 AS ORDEM			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO			, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO			, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)			 GROUP BY  PAI.CODNAT			ORDER BY 1]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="ORDEM" label="Ordem" type="F" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Jan" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEVEREIRO" label="Fev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MARCO" label="Mai" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABRIL" label="Abr" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAIO" label="Mai" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUNHO" label="Jun" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JULHO" label="Jul" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGOSTO" label="Ago" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SETEMBRO" label="Sete" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUTUBRO" label="Outu" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOVEMBRO" label="Nov" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZEMBRO" label="Dez" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TOTAL" label="Total" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          </metadata>
          <on-click navigate-to="lvl_a57pz3k">
            <param id="A_CODNAT">$CODNAT</param>
          </on-click>
          <refresh-details ui-list="cht_a57pzkz">
            <param id="A_CODNAT">$CODNAT</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_a57pzkz" type="column">
          <args>
            <arg id="A_CODNAT" type="integer"/>
          </args>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT			, PAI.DESCRNAT		    , EXTRACT(MONTH FROM FIN.DTNEG) AS MES			, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,3) IN(306)		AND PAI.CODNAT = :A_CODNAT			 GROUP BY  PAI.CODNAT			, PAI.DESCRNAT			 ,EXTRACT(MONTH FROM FIN.DTNEG)       UNION ALL  SELECT PAI.CODNAT		    , 'OUTROS GASTOS ' AS DESCRNAT		    , EXTRACT(MONTH FROM FIN.DTNEG) AS MES			, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)		AND PAI.CODNAT = :A_CODNAT			 GROUP BY  PAI.CODNAT			, PAI.DESCRNAT			 ,EXTRACT(MONTH FROM FIN.DTNEG)       UNION ALL  SELECT PAI.CODNAT		    , 'IRPJ E CSLL' AS DESCRNAT		    , EXTRACT(MONTH FROM FIN.DTNEG) AS MES			, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)		AND PAI.CODNAT = :A_CODNAT			 GROUP BY  PAI.CODNAT			 ,EXTRACT(MONTH FROM FIN.DTNEG)			   ORDER BY 3 ASC]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
          </metadata>
          <vertical-axis>
            <linear resultRotation="0" vResizing="true">
              <mask>#.##0,00;(n)</mask>
            </linear>
          </vertical-axis>
          <series>
            <serie type="column">
              <xField>$MES</xField>
              <yField>$TOTAL</yField>
              <display><![CDATA[Cód. Natureza:$CODNAT<br>Natureza:$DESCRNAT]]></display>
              <color>0x2a7344</color>
              <on-click navigate-to="lvl_a57pzjf">
                <param id="A_CODNAT">$CODNAT</param>
                <param id="A_MES">$MES</param>
              </on-click>
            </serie>
          </series>
        </chart>
      </container>
    </container>
  </level>
  <level id="lvl_a57pzjf" description="Análitico 2 Invest. e Emprést.">
    <args>
      <arg id="A_CODNAT" type="integer"/>
      <arg id="A_MES" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_a57pzjg" useNewGrid="S">
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,3) IN(306)		AND PAI.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MESUNION ALLSELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)		AND PAI.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MES		UNION ALLSELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)		AND PAI.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MES]]></expression>
        <metadata>
          <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
          <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
          <field name="NUFIN" label="Nro. Único" type="I" visible="true" useFooter="false"/>
          <field name="NUMNOTA" label="NFE" type="I" visible="true" useFooter="false"/>
          <field name="CODPARC" label="Cód. Parceiro" type="I" visible="true" useFooter="false"/>
          <field name="RAZAOSOCIAL" label="Razão Social" type="S" visible="true" useFooter="false"/>
          <field name="DTNEG" label="Dt. Negociação" type="D" visible="true" useFooter="false"/>
          <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          <field name="DHBAIXA" label="Dh. Baixa" type="D" visible="true" useFooter="false"/>
          <field name="VLR" label="Vlr. Total" type="I" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
          <field name="HISTORICO" label="Historico" type="S" visible="true" useFooter="false"/>
        </metadata>
        <on-click-launcher resource-id="br.com.sankhya.fin.cad.movimentacaoFinanceira">
          <NUFIN>$NUFIN</NUFIN>
        </on-click-launcher>
      </grid>
    </container>
  </level>
  <level id="lvl_a57pz3k" description="Análitico 3 Invest. e Emprést.">
    <args>
      <arg id="A_CODNAT" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_a57pz3o" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT FIN.CODNAT		, NAT.DESCRNAT		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,3) IN(306)    AND PAI.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNATUNION ALL SELECT FIN.CODNAT		, NAT.DESCRNAT		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)    AND PAI.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNAT		UNION ALL		SELECT FIN.CODNAT		, NAT.DESCRNAT		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 01 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JANEIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 02 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS FEVEREIRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 03 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MARCO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 04 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS ABRIL		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 05 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS MAIO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 06 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JUNHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 07 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS JULHO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 08 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS AGOSTO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 09 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS SETEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 10 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS OUTUBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 11 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS NOVEMBRO		, SUM(CASE WHEN TO_CHAR(FIN.DTNEG,'MM') = 12 THEN  (FIN.VLRDESDOB * FIN.RECDESP) ELSE 0 END) AS DEZEMBRO		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO	AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)    AND PAI.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNAT		ORDER BY 1]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="JANEIRO" label="Jan" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="FEVEREIRO" label="Fev" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MARCO" label="Mar" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="ABRIL" label="Abr" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="MAIO" label="Mai" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="JUNHO" label="Jun" type="I" visible="true" useFooter="AVG" mask="#.##0,00;(n)"/>
            <field name="JULHO" label="Jul" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="AGOSTO" label="Ago" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="SETEMBRO" label="Sete" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="OUTUBRO" label="Outu" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="NOVEMBRO" label="Nov" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="DEZEMBRO" label="Dez" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          </metadata>
          <refresh-details ui-list="cht_a57pz3n">
            <param id="A_CODNAT">$CODNAT</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_a57pz3n" type="column">
          <args>
            <arg id="A_CODNAT" type="integer"/>
          </args>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT   FIN.CODNAT		, NAT.DESCRNAT		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL        , EXTRACT(MONTH FROM FIN.DTNEG) AS MES FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,3) IN(306)    AND FIN.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNAT		, EXTRACT(MONTH FROM FIN.DTNEG)		UNION ALLSELECT   FIN.CODNAT		, NAT.DESCRNAT		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL        , EXTRACT(MONTH FROM FIN.DTNEG) AS MES FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)    AND FIN.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNAT		, EXTRACT(MONTH FROM FIN.DTNEG)UNION ALLSELECT   FIN.CODNAT		, NAT.DESCRNAT		, SUM((FIN.VLRDESDOB * FIN.RECDESP) ) AS TOTAL        , EXTRACT(MONTH FROM FIN.DTNEG) AS MES FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC				INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT				LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI  WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN	AND FIN.PROVISAO <> 'S'    AND FIN.CODEMP IN :P_CODEMP    AND FIN.CODCENCUS IN :P_CODCENCUS    AND FIN.CODPROJ IN :P_PROJETO	AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)    AND FIN.CODNAT = :A_CODNAT	 GROUP BY  FIN.CODNAT		, NAT.DESCRNAT		, EXTRACT(MONTH FROM FIN.DTNEG) ORDER BY 4]]></expression>
          <metadata>
            <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
            <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
            <field name="TOTAL" label="Total" type="I" visible="true" useFooter="false" mask="#.##0,00;(n)"/>
            <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          </metadata>
          <vertical-axis>
            <linear resultRotation="0" vResizing="true">
              <mask>#.##0,00;(n)</mask>
            </linear>
          </vertical-axis>
          <series>
            <serie type="column">
              <xField>$MES</xField>
              <yField>$TOTAL</yField>
              <display><![CDATA[Cód. Natureza:$CODNAT<br>Natureza:$DESCRNAT]]></display>
              <color>0x2a7344</color>
              <on-click navigate-to="lvl_a57pz3l">
                <param id="A_CODNAT">$CODNAT</param>
                <param id="A_MES">$MES</param>
              </on-click>
            </serie>
          </series>
        </chart>
      </container>
    </container>
  </level>
  <level id="lvl_a57pz3l" description="Análitico 4 Invest. e Emprést.">
    <args>
      <arg id="A_CODNAT" type="integer"/>
      <arg id="A_MES" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_a57pz3m" useNewGrid="S">
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,3) IN(306)		AND NAT.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MES		--AND PAI.GRAU <> 1UNION ALL SELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND SUBSTR(FIN.CODNAT,1,1) IN(5)		AND SUBSTR(FIN.CODNAT,1,3) NOT IN (503, 504, 507, 509, 510, 511, 517, 521, 523, 526, 530, 540, 550, 570, 580)		AND NAT.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MES		UNION ALL SELECT PAI.CODNAT		, PAI.DESCRNAT		, FIN.NUFIN		, FIN.NUMNOTA		, FIN.CODPARC	    , PAR.RAZAOSOCIAL		, FIN.DTNEG		, EXTRACT(MONTH FROM FIN.DTNEG) AS MES		, FIN.DHBAIXA		, FIN.VLRDESDOB * FIN.RECDESP AS VLR		, FIN.HISTORICO	 FROM TGFFIN FIN INNER JOIN TGFPAR PAR ON PAR.CODPARC = FIN.CODPARC					INNER JOIN TGFNAT NAT ON NAT.CODNAT = FIN.CODNAT					LEFT JOIN TGFNAT PAI ON  PAI.CODNAT = NAT.CODNATPAI	 	 WHERE FIN.DTNEG BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN		AND FIN.PROVISAO <> 'S'        AND FIN.CODEMP IN :P_CODEMP        AND FIN.CODCENCUS IN :P_CODCENCUS        AND FIN.CODPROJ IN :P_PROJETO		AND FIN.CODNAT IN (1110900,5170000, 1110800, 5210000)		AND NAT.CODNAT IN :A_CODNAT		AND EXTRACT(MONTH FROM FIN.DTNEG) = :A_MES]]></expression>
        <metadata>
          <field name="CODNAT" label="Cód. Natureza" type="I" visible="true" useFooter="false"/>
          <field name="DESCRNAT" label="Natureza" type="S" visible="true" useFooter="false"/>
          <field name="NUFIN" label="Nro. Único" type="I" visible="true" useFooter="false"/>
          <field name="NUMNOTA" label="NFE" type="I" visible="true" useFooter="false"/>
          <field name="CODPARC" label="Cód. Parceiro" type="I" visible="true" useFooter="false"/>
          <field name="RAZAOSOCIAL" label="Razão Social" type="S" visible="true" useFooter="false"/>
          <field name="DTNEG" label="Dt. Negociação" type="D" visible="true" useFooter="false"/>
          <field name="MES" label="Mes" type="I" visible="true" useFooter="false"/>
          <field name="DHBAIXA" label="Dh. Baixa" type="D" visible="true" useFooter="false"/>
          <field name="VLR" label="Vlr. Total" type="I" visible="true" useFooter="SUM" mask="#.##0,00;(n)"/>
          <field name="HISTORICO" label="Historico" type="S" visible="true" useFooter="false"/>
        </metadata>
        <on-click-launcher resource-id="br.com.sankhya.fin.cad.movimentacaoFinanceira">
          <NUFIN>$NUFIN</NUFIN>
        </on-click-launcher>
      </grid>
    </container>
  </level>
</gadget>